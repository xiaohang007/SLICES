<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>invcryrep package &#8212; SLCIES v1.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=039e1c02" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=ae58c2e2"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="invcryrep-package">
<h1>invcryrep package<a class="headerlink" href="#invcryrep-package" title="Permalink to this heading">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-invcryrep.config">
<span id="invcryrep-config-module"></span><h2>invcryrep.config module<a class="headerlink" href="#module-invcryrep.config" title="Permalink to this heading">¶</a></h2>
</section>
<section id="module-invcryrep.invcryrep">
<span id="invcryrep-invcryrep-module"></span><h2>invcryrep.invcryrep module<a class="headerlink" href="#module-invcryrep.invcryrep" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">invcryrep.invcryrep.</span></span><span class="sig-name descname"><span class="pre">InvCryRep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">to_jimages</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">graph_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'econnn'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_results</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BFGS'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Invertible Crystal Representation (SLICES and labeled quotient graph)</p>
<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.SLICES2formula">
<span class="sig-name descname"><span class="pre">SLICES2formula</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SLICES</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.SLICES2formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a SLICES string to its chemical formula (to facilitate composition screening
before SLICES2structure).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>SLICES</strong> (<em>str</em>) – A SLICES string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Chemical formula.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.SLICES2structure">
<span class="sig-name descname"><span class="pre">SLICES2structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SLICES</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.SLICES2structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a SLICES string back to its original crystal structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>SLICES</strong> (<em>str</em>) – A SLICES string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A pymatgen Structure object.
float: Energy per atom predicted with M3GNet.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Structure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.all_distances">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">all_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.all_distances" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the distances between two lists of coordinates</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords1</strong> – First set of Cartesian coordinates.</p></li>
<li><p><strong>coords2</strong> – Second set of Cartesian coordinates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>2d array of Cartesian distances. E.g the distance between</dt><dd><p>coords1[i] and coords2[j] is distances[i,j]</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.check_SLICES">
<span class="sig-name descname"><span class="pre">check_SLICES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SLICES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dupli_check</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.check_SLICES" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a slices string conforms to the proper syntax.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SLICES</strong> (<em>str</em>) – A SLICES string.</p></li>
<li><p><strong>dupli_check</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag to indicate whether to check if a SLICES has duplicate
edges. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return True if a SLICES is syntaxlly valid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.check_element">
<span class="sig-name descname"><span class="pre">check_element</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.check_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Make sure no atoms with atomic numbers higher than 86 (due to GFN-FF’s limitation).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Return True if all atoms with Z &lt; 87.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.check_structural_validity">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">check_structural_validity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">str1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.check_structural_validity" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the structural validity of a Structure with minimal distance &gt; 0.5 Ang.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>str1</strong> (<em>Structure</em>) – Input Structure.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return True if Structure is structurally valid.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.cif2structure_graph">
<span class="sig-name descname"><span class="pre">cif2structure_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.cif2structure_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a cif string to a structure_graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>string</strong> (<em>str</em>) – String of a cif file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pymatgen structure_graph object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>StructureGraph</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.convert_graph">
<span class="sig-name descname"><span class="pre">convert_graph</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.convert_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert self.edge_indices, self.to_jimages into networkx format.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>x_dat.
list: net_voltage(edge labels).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.convert_params">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">convert_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cocycle_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_tensor_std</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.convert_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract metric tensor and cocycle rep from x vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – Ndarray of metric tensor components and colattice vectors.</p></li>
<li><p><strong>ndim</strong> (<em>int</em>) – Dimensionality of crystal structure corresponding to the labeled quotient graph.</p></li>
<li><p><strong>cocycle_size</strong> (<em>int</em>) – Size of the cocycle vectors.</p></li>
<li><p><strong>lattice_type</strong> (<em>int</em>) – Lattice type. 1: a=b=c, 21: a!=b=c, 22: b!=a=c, 23: c!=a=b , 3: a!=b!=c.</p></li>
<li><p><strong>metric_tensor_std</strong> (<em>np.array</em>) – Metric tensor of the barycentric embedding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated metric tensor based on colattice vectors, x.
np.array: Cocycle rep, the bottom n-1 rows of the alpha matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.file2structure_graph">
<span class="sig-name descname"><span class="pre">file2structure_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.file2structure_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a file to a pymatgen structure_graph object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Filename.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Pymatgen structure_graph object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>StructureGraph</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.from_SLICES">
<span class="sig-name descname"><span class="pre">from_SLICES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SLICES</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix_duplicate_edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.from_SLICES" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract edge_indices, to_jimages and atom_types from decoding a SLICES string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>SLICES</strong> (<em>due to RNN's difficulty in learning long SLICES</em>) – SLICES string.</p></li>
<li><p><strong>fix_duplicate_edge</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag to indicate whether to fix duplicate edges in</p></li>
<li><p><strong>SLICES</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>Exception</strong> – Error: wrong edge indices.</p></li>
<li><p><strong>Exception</strong> – Error: wrong edge label.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.from_cif">
<span class="sig-name descname"><span class="pre">from_cif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.from_cif" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract edge_indices, to_jimages and atom_types from a cif string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>string</strong> (<em>str</em>) – String of a cif file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.from_file">
<span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract edge_indices, to_jimages and atom_types from a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Filename.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.from_structure">
<span class="sig-name descname"><span class="pre">from_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.from_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract edge_indices, to_jimages and atom_types from a pymatgen structure object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>structure</strong> (<em>Structure</em>) – A pymatgen Structure.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.func">
<span class="sig-name descname"><span class="pre">func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colattice_inds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colattice_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cycle_rep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cycle_cocycle_I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortest_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spanning</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncovered_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncovered_pair_lj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covered_pair_lj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbond_param_ave_covered</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbond_param_ave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_vectors_scaled</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_tensor_std</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.func" title="Permalink to this definition">¶</a></dt>
<dd><p>Objective function: sum squared differences between the inner products of the GFN-FF predicted
geometry and the associated inner products (gjk) of the edges in the non-barycentric embedded net.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – Ndarray of metric tensor components and colattice vectors.</p></li>
<li><p><strong>ndim</strong> (<em>int</em>) – Dimensionality of crystal structure corresponding to the labeled quotient graph.</p></li>
<li><p><strong>order</strong> (<em>int</em>) – Number of nodes of the labeled quotient graph.</p></li>
<li><p><strong>mat_target</strong> (<em>np.array</em>) – Inner product matrix target calculated with GFNFF predicted geometry.</p></li>
<li><p><strong>colattice_inds</strong> (<em>list</em>) – keep track of all the valid colattice dot indices.</p></li>
<li><p><strong>colattice_weights</strong> (<em>list</em>) – Colattice weights for bond or angle.</p></li>
<li><p><strong>cycle_cocycle_I</strong> (<em>np.array</em>) – The inverse of B matrix.</p></li>
<li><p><strong>num_nodes</strong> (<em>int</em>) – Number of nodes of the labeled quotient graph(duplicate! not deleted due to
compatibility of HTS scripts, will be deleted in future).</p></li>
<li><p><strong>shortest_path</strong> (<em>list</em>) – Shortest path of the spanning graph of the labeled quotient graph.</p></li>
<li><p><strong>spanning</strong> (<em>list</em>) – Spanning graph of the labeled quotient graph.</p></li>
<li><p><strong>uncovered_pair</strong> (<em>list</em>) – Atom pairs not covered by edges of the structure graph.</p></li>
<li><p><strong>covered_pair_lj</strong> (<em>list</em>) – lj parameters for atom pairs covered by edges of the structure graph.</p></li>
<li><p><strong>vbond_param_ave_covered</strong> (<em>float</em>) – Repulsive potential well depth of atom pairs covered by edges
of the structure graph.</p></li>
<li><p><strong>vbond_param_ave</strong> (<em>float</em>) – Repulsive potential well depth of atom pairs not covered by edges of
the structure graph.</p></li>
<li><p><strong>structure_species</strong> (<em>list</em>) – Atom symbols of the labeled quotient graph.</p></li>
<li><p><strong>angle_weight</strong> (<em>float</em>) – Weight of angular terms in the object function.</p></li>
<li><p><strong>repul</strong> (<em>bool</em>) – Flag to indicate whether repulsive potential is considered in the object function.</p></li>
<li><p><strong>lattice_type</strong> (<em>int</em>) – Lattice type. 1: a=b=c, 21: a!=b=c, 22: b!=a=c, 23: c!=a=b , 3: a!=b!=c.</p></li>
<li><p><strong>metric_tensor_std</strong> (<em>np.array</em>) – Metric tensor of the barycentric embedding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the object function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.func_check">
<span class="sig-name descname"><span class="pre">func_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colattice_inds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colattice_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cycle_rep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cycle_cocycle_I</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortest_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spanning</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncovered_pair</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncovered_pair_lj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covered_pair_lj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbond_param_ave_covered</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbond_param_ave</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_vectors_scaled</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_species</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repul</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_tensor_std</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.func_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Objective function: sum squared differences between the inner products of the GFN-FF predicted
geometry and the associated inner products (gjk) of the edges in the non-barycentric embedded net.
This version of func() will output debug info.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.array</em>) – Ndarray of metric tensor components and colattice vectors.</p></li>
<li><p><strong>ndim</strong> (<em>int</em>) – Dimensionality of crystal structure corresponding to the labeled quotient graph.</p></li>
<li><p><strong>order</strong> (<em>int</em>) – Number of nodes of the labeled quotient graph.</p></li>
<li><p><strong>mat_target</strong> (<em>np.array</em>) – Inner product matrix target calculated with GFNFF predicted geometry.</p></li>
<li><p><strong>colattice_inds</strong> (<em>list</em>) – keep track of all the valid colattice dot indices.</p></li>
<li><p><strong>colattice_weights</strong> (<em>list</em>) – Colattice weights for bond or angle.</p></li>
<li><p><strong>cycle_cocycle_I</strong> (<em>np.array</em>) – The inverse of B matrix.</p></li>
<li><p><strong>num_nodes</strong> (<em>int</em>) – Number of nodes of the labeled quotient graph(duplicate! not deleted due to
compatibility of HTS scripts, will be deleted in future).</p></li>
<li><p><strong>shortest_path</strong> (<em>list</em>) – Shortest path of the spanning graph of the labeled quotient graph.</p></li>
<li><p><strong>spanning</strong> (<em>list</em>) – Spanning graph of the labeled quotient graph.</p></li>
<li><p><strong>uncovered_pair</strong> (<em>list</em>) – Atom pairs not covered by edges of the structure graph.</p></li>
<li><p><strong>covered_pair_lj</strong> (<em>list</em>) – lj parameters for atom pairs covered by edges of the structure graph.</p></li>
<li><p><strong>vbond_param_ave_covered</strong> (<em>float</em>) – Repulsive potential well depth of atom pairs covered by edges
of the structure graph.</p></li>
<li><p><strong>vbond_param_ave</strong> (<em>float</em>) – Repulsive potential well depth of atom pairs not covered by edges of
the structure graph.</p></li>
<li><p><strong>structure_species</strong> (<em>list</em>) – Atom symbols of the labeled quotient graph.</p></li>
<li><p><strong>angle_weight</strong> (<em>float</em>) – Weight of angular terms in the object function.</p></li>
<li><p><strong>repul</strong> (<em>bool</em>) – Flag to indicate whether repulsive potential is considered in the object function.</p></li>
<li><p><strong>lattice_type</strong> (<em>int</em>) – Lattice type. 1: a=b=c, 21: a!=b=c, 22: b!=a=c, 23: c!=a=b , 3: a!=b!=c.</p></li>
<li><p><strong>metric_tensor_std</strong> (<em>np.array</em>) – Metric tensor of the barycentric embedding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the object function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.get_canonical_SLICES">
<span class="sig-name descname"><span class="pre">get_canonical_SLICES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">SLICES</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.get_canonical_SLICES" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a SLICES to its canonical form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>SLICES</strong> (<em>str</em>) – A SLICES string.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The canonical SLICES string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.get_coordinates">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_coordinates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arc_coord</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_nodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shortest_path_spanning_graph</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spanning</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.get_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Get fractional coordinates of atoms from fractional coordinates of edge vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arc_coord</strong> (<em>np.array</em>) – Edge vectors (fractional coords) of a labeled quotient graph.</p></li>
<li><p><strong>num_nodes</strong> (<em>int</em>) – Number of atoms(nodes) of a labeled quotient graph.</p></li>
<li><p><strong>shortest_path_spanning_graph</strong> (<em>list</em>) – Shortest path of the spanning graph of a labeled
quotient graph.</p></li>
<li><p><strong>spanning</strong> (<em>list</em>) – Spanning graph of a labeled quotient graph.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Fractional coordinates of atoms.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.get_covered_pair_lj">
<span class="sig-name descname"><span class="pre">get_covered_pair_lj</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.get_covered_pair_lj" title="Permalink to this definition">¶</a></dt>
<dd><p>Get atom pairs covered by edges of the structure graph stored in self.atom_types.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Atom pairs covered by edges of the structure graph.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.get_dim">
<span class="sig-name descname"><span class="pre">get_dim</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.get_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the dimension of a Structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>structure</strong> (<em>Structure</em>) – A pymatgen Structure.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The dimension of a Structure.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.get_inner_p_target">
<span class="sig-name descname"><span class="pre">get_inner_p_target</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.get_inner_p_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Get inner product matrix, colattice indices, colattice weights.</p>
<ol class="arabic simple">
<li><p>Get inner_p_target(inner_p matrix obtained by gfnff).</p></li>
<li><p>Get colattice_inds(keep track of all the valid colattice dot indices).</p></li>
<li><p>Get colattice_weights(colattice weights for bond or angle).</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bond_scaling</strong> (<em>float</em><em>, </em><em>optional</em>) – Bond scaling factor. Defaults to 1.05.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Inner product matrix.
list: Colattice indices.
list: Colattice weights.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.get_inner_p_target_debug">
<span class="sig-name descname"><span class="pre">get_inner_p_target_debug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.05</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.get_inner_p_target_debug" title="Permalink to this definition">¶</a></dt>
<dd><p>Get inner product matrix, colattice indices, colattice weights with debug outputs.</p>
<ol class="arabic simple">
<li><p>Get inner_p_target(inner_p matrix obtained by gfnff).</p></li>
<li><p>Get colattice_inds(keep track of all the valid colattice dot indices).</p></li>
<li><p>Get colattice_weights(colattice weights for bond or angle).</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>bond_scaling</strong> (<em>float</em><em>, </em><em>optional</em>) – Bond scaling factor. Defaults to 1.05.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Inner product matrix.
list: Colattice indices.
list: Colattice weights.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.get_nbf_blist">
<span class="sig-name descname"><span class="pre">get_nbf_blist</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.get_nbf_blist" title="Permalink to this definition">¶</a></dt>
<dd><ol class="arabic simple">
<li><p>Get nbf(neighbor list with atom types for xtb_mod).
(2) Get blist(node indexes of the central unit cell edges in the 3*3*3 supercell).</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>nbf.
np.array: blist.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.get_rescaled_lattice_vectors">
<span class="sig-name descname"><span class="pre">get_rescaled_lattice_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inner_p_target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inner_p_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_vectors_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">arc_coord_std</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.get_rescaled_lattice_vectors" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Get rescaled_lattice_vectors based on the GFNFF bond lengths calculated using the</dt><dd><p>topological neighbor list as input.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inner_p_target</strong> (<em>np.array</em>) – Inner product matrix obtained by GFNFF.</p></li>
<li><p><strong>inner_p_std</strong> (<em>np.array</em>) – Inner product matrix of the barycentric embedding.</p></li>
<li><p><strong>lattice_vectors_std</strong> (<em>np.array</em>) – Lattice vectors of the barycentric embedding.</p></li>
<li><p><strong>arc_coord_std</strong> (<em>np.array</em>) – Edge vectors (fractional coords) of the barycentric embedding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Rescaled lattice vectors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.get_uncovered_pair">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_uncovered_pair</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.get_uncovered_pair" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Get atom pairs not covered by edges of the structure graph. Assuming that all atoms</dt><dd><p>has been included in graph.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>graph</strong> (<em>Graph</em>) – Networkx graph.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Atom pairs not covered by edges of the structure graph.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.get_uncovered_pair_lj">
<span class="sig-name descname"><span class="pre">get_uncovered_pair_lj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uncovered_pair</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.get_uncovered_pair_lj" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the lj parameters for atom pairs not covered by edges of the structure graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>uncovered_pair</strong> (<em>list</em>) – Atom pairs not covered by edges of the structure graph.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>lj parameters for atom pairs not covered by edges of the structure graph.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.initialize_x_bounds">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize_x_bounds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cocycle_rep</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_tensor_std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_expand</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_shrink</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.initialize_x_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize x vectors and bounds based on metric_tensor_std, lattice_type and other settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ndim</strong> (<em>int</em>) – Dimensionality of crystal structure corresponding to the labeled quotient graph.</p></li>
<li><p><strong>cocycle_rep</strong> (<em>np.array</em>) – Cocycle rep, the bottom n-1 rows of the alpha matrix.</p></li>
<li><p><strong>metric_tensor_std</strong> (<em>np.array</em>) – Metric tensor of the barycentric embedding.</p></li>
<li><p><strong>lattice_type</strong> (<em>int</em>) – Lattice type. 1: a=b=c, 21: a!=b=c, 22: b!=a=c, 23: c!=a=b , 3: a!=b!=c.</p></li>
<li><p><strong>delta_theta</strong> (<em>float</em>) – Angle change limit(deprecated! not deleted due to compatibility of HTS
scripts, will be deleted in future).</p></li>
<li><p><strong>delta_x</strong> (<em>float</em>) – Maximum x change allowed.</p></li>
<li><p><strong>lattice_expand</strong> (<em>float</em>) – Maximum lattice expansion allowed.</p></li>
<li><p><strong>lattice_shrink</strong> (<em>float</em>) – Maximum lattice shrinkage allowed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Intitial value of x.
list: Upper and lower bounds of x.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.m3gnet_relax">
<span class="sig-name descname"><span class="pre">m3gnet_relax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">struc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.m3gnet_relax" title="Permalink to this definition">¶</a></dt>
<dd><p>Cell optimization using M3GNet IAPs (time limit is set to XX seconds
to prevent buggy cell optimization that takes fovever to finish).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>struc</strong> (<em>Structure</em>) – A pymatgen Structure object.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Optimized pymatgen Structure object with M3GNet IAP.
float: Energy per atom predicted with M3GNet.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Structure</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.match_check">
<span class="sig-name descname"><span class="pre">match_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.match_check" title="Permalink to this definition">¶</a></dt>
<dd><ol class="arabic simple">
<li><p>Calculate match rates of structure (2) and (1) with respect to the
original structure.</p></li>
<li><p>Calculate topological(Jaccard) distances of structuregraph of structure
(2) and (1) with respect to structuregraph of the original structure.</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.match_check2">
<span class="sig-name descname"><span class="pre">match_check2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.match_check2" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate match rates of structure (2) and (1) with respect to the
original structure.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.match_check3">
<span class="sig-name descname"><span class="pre">match_check3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.match_check3" title="Permalink to this definition">¶</a></dt>
<dd><ol class="arabic simple">
<li><p>Calculate match rates of structure (3), (2) and (1) with
respect to the original structure.</p></li>
<li><p>Calculate topological distances of structuregraph of structure (3), (2)
and (1) with respect to structuregraph of the original structure.</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.match_check4">
<span class="sig-name descname"><span class="pre">match_check4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ori</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.match_check4" title="Permalink to this definition">¶</a></dt>
<dd><ol class="arabic">
<li><dl class="simple">
<dt>Calculate match rates of structure (3), (2), (4) and (1) with respect to the</dt><dd><p>original structure.</p>
</dd>
</dl>
<ol class="arabic simple" start="2">
<li><p>Calculate topological distances of structuregraph of structure (3), (2), (4)
and (1) with respect to structuregraph of the original structure.</p></li>
</ol>
</li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ori</strong> (<em>Structure</em>) – Original Structure.</p></li>
<li><p><strong>opt2</strong> (<em>Structure</em>) – IAP-optimized Structure.</p></li>
<li><p><strong>opt</strong> (<em>Structure</em>) – ZL*-Optimized Structure.</p></li>
<li><p><strong>std2</strong> (<em>Structure</em>) – IAP-optimized rescaled Structure.</p></li>
<li><p><strong>std</strong> (<em>Structure</em>) – Rescaled Structure.</p></li>
<li><p><strong>ltol</strong> (<em>float</em><em>, </em><em>optional</em>) – Fractional length tolerance. Default is 0.2.</p></li>
<li><p><strong>stol</strong> (<em>float</em><em>, </em><em>optional</em>) – Site tolerance. Defined as the fraction of the average
free length per atom := ( V / Nsites ) ** (1/3). Default is 0.3.</p></li>
<li><p><strong>angle_tol</strong> (<em>int</em><em>, </em><em>optional</em>) – Angle tolerance in degrees. Default is 5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>“1” if IAP-optimized Structure matches original Structure. “0” otherwise.
str: “1” if ZL*-Optimized Structure matches original Structure. “0” otherwise.
str: “1” if IAP-optimized rescaled Structure matches original Structure. “0” otherwise.
str: “1” if Rescaled Structure matches original Structure. “0” otherwise.
str: The topological distance between IAP-optimized Structure and original Structure.
str: The topological distance between ZL*-Optimized Structure and original Structure.
str: The topological distance between IAP-optimized Rescaled Structure and original Structure.
str: The topological distance between Rescaled Structure and original Structure.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.structure2SLICES">
<span class="sig-name descname"><span class="pre">structure2SLICES</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.structure2SLICES" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Extract edge_indices, to_jimages and atom_types from a pymatgen structure object</dt><dd><p>then encode them into a SLICES string.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – A pymatgen Structure.</p></li>
<li><p><strong>strategy</strong> (<em>int</em><em>, </em><em>optional</em>) – Strategy number. Defaults to 3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A SLICES string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.structure2SLICESAug">
<span class="sig-name descname"><span class="pre">structure2SLICESAug</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strategy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.structure2SLICESAug" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert Structure to SLICES and conduct data augmentation.</p>
<ol class="arabic simple">
<li><p>extract edge_indices, to_jimages and atom_types from a pymatgen structure object</p></li>
<li><p>encoding edge_indices, to_jimages and atom_types into multiple equalivent SLICES strings
with a data augmentation scheme</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – A pymatgen Structure.</p></li>
<li><p><strong>strategy</strong> (<em>int</em><em>, </em><em>optional</em>) – Strategy number. Defaults to 3.</p></li>
<li><p><strong>num</strong> (<em>int</em><em>, </em><em>optional</em>) – Increase the dataset size by a magnitude of num. Defaults to 200.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of num SLICES strings.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.structure2crystal_graph_rep">
<span class="sig-name descname"><span class="pre">structure2crystal_graph_rep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.structure2crystal_graph_rep" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>convert a pymatgen structure object into the crystal graph representation:</dt><dd><p>atom_types, edge_indices, to_jimages.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>structure</strong> (<em>_type_</em>) – _description_</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Atom types.
np.array: Edge indices.
np.array: Edge labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.structure2structure_graph">
<span class="sig-name descname"><span class="pre">structure2structure_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.structure2structure_graph" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a pymatgen structure to a structure_graph.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>structure</strong> (<em>Structure</em>) – A pymatgen Structure.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A Pymatgen StructureGraph object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>StructureGraph</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.to_4structures">
<span class="sig-name descname"><span class="pre">to_4structures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_shrink</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_expand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbond_param_ave_covered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbond_param_ave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.to_4structures" title="Permalink to this definition">¶</a></dt>
<dd><p>Designed for benchmark.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.to_SLICES">
<span class="sig-name descname"><span class="pre">to_SLICES</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.to_SLICES" title="Permalink to this definition">¶</a></dt>
<dd><p>Output a SLICES string based on self.atom_types &amp; self.edge_indices &amp; self.to_jimages.
:returns: SLICES string.
:rtype: str</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.to_relaxed_structure">
<span class="sig-name descname"><span class="pre">to_relaxed_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_shrink</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_expand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbond_param_ave_covered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbond_param_ave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.to_relaxed_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert edge_indices, to_jimages and atom_types stored in the InvCryRep instance back to
a pymatgen structure object: non-barycentric net embedding undergone cell optimization
using M3GNet IAPs.
If cell optimization failed, then raise error.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.to_structure">
<span class="sig-name descname"><span class="pre">to_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_shrink</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_expand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbond_param_ave_covered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbond_param_ave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.to_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert edge_indices, to_jimages and atom_types stored in the InvCryRep instance back to
a pymatgen structure object: non-barycentric net embedding undergone cell optimization
using M3GNet IAPs. If cell optimization failed, then output non-barycentric net embedding
that matches bond lengths and bond angles predicted with modified GFN-FF.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.invcryrep.InvCryRep.to_structures">
<span class="sig-name descname"><span class="pre">to_structures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bond_scaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.005</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_shrink</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_expand</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.25</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbond_param_ave_covered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vbond_param_ave</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">repul</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.InvCryRep.to_structures" title="Permalink to this definition">¶</a></dt>
<dd><p>The inverse transform of the crystal graph of a SLICES string to its crystal structure.
Convert edge_indices, to_jimages and atom_types stored in the InvCryRep instance back to
3 pymatgen structure objects and the energy per atom predicted with M3GNet.</p>
<ol class="arabic simple">
<li><p>barycentric embedding net with rescaled lattice based on the average bond scaling factors</p></li>
</ol>
<blockquote>
<div><p>calculated with modified GFN-FF predicted geometry</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><p>non-barycentric net embedding that matches bond lengths and bond angles predicted with</p></li>
</ol>
<blockquote>
<div><p>modified GFN-FF</p>
</div></blockquote>
<p>(3) non-barycentric net embedding undergone cell optimization using M3GNet IAPs
if cell optimization failed, then output (1) and (2)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bond_scaling</strong> (<em>float</em><em>, </em><em>optional</em>) – Bond scaling factor. Defaults to 1.05.</p></li>
<li><p><strong>delta_theta</strong> (<em>float</em>) – Angle change limit(deprecated! not deleted due to compatibility of HTS
scripts, will be deleted in future).</p></li>
<li><p><strong>delta_x</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum x change allowed. Defaults to 0.45.</p></li>
<li><p><strong>lattice_shrink</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum lattice shrinkage allowed. Defaults to 1.</p></li>
<li><p><strong>lattice_expand</strong> (<em>float</em><em>, </em><em>optional</em>) – Maximum lattice expansion allowed. Defaults to 1.25.</p></li>
<li><p><strong>angle_weight</strong> (<em>float</em><em>, </em><em>optional</em>) – Weight of angular terms in the object function. Defaults to 0.5.</p></li>
<li><p><strong>vbond_param_ave_covered</strong> (<em>float</em><em>, </em><em>optional</em>) – Repulsive potential well depth of atom pairs covered
by edges of the structure graph. Defaults to 0.00.</p></li>
<li><p><strong>vbond_param_ave</strong> (<em>float</em><em>, </em><em>optional</em>) – Repulsive potential well depth of atom pairs not covered by
edges of the structure graph. Defaults to 0.01.</p></li>
<li><p><strong>repul</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flag to indicate whether repulsive potential is considered in the object
function. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>[Rescaled Structure, ZL*-optimized Structure,  IAP-optimized Structure]
float: Energy per atom predicted with M3GNet.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="invcryrep.invcryrep.function_timeout">
<span class="sig-prename descclassname"><span class="pre">invcryrep.invcryrep.</span></span><span class="sig-name descname"><span class="pre">function_timeout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seconds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.invcryrep.function_timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a decorator that sets a time limit for a function call.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>seconds</strong> (<em>int</em>) – Time limit.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>SystemExit</strong> – Timeout exception.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Timeout Decorator.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Decorator</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-invcryrep.tobascco_net">
<span id="invcryrep-tobascco-net-module"></span><h2>invcryrep.tobascco_net module<a class="headerlink" href="#module-invcryrep.tobascco_net" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">invcryrep.tobascco_net.</span></span><span class="sig-name descname"><span class="pre">Net</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">graph</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.add_edge">
<span class="sig-name descname"><span class="pre">add_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.add_edge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.add_edges_between">
<span class="sig-name descname"><span class="pre">add_edges_between</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.add_edges_between" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.add_name">
<span class="sig-name descname"><span class="pre">add_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.add_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.add_to_array">
<span class="sig-name descname"><span class="pre">add_to_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rep</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.add_to_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Works assuming the dimensions are the same</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.add_vertex">
<span class="sig-name descname"><span class="pre">add_vertex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.add_vertex" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.all_edges">
<span class="sig-name descname"><span class="pre">all_edges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.all_edges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.assign_ip_matrix">
<span class="sig-name descname"><span class="pre">assign_ip_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inds</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.assign_ip_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the colattice dot matrix from Builder.py. This is an inner
product matrix of all the SBUs assigned to particular nodes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.barycentric_embedding">
<span class="sig-name descname"><span class="pre">barycentric_embedding</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.barycentric_embedding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.check_linear_dependency">
<span class="sig-name descname"><span class="pre">check_linear_dependency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.check_linear_dependency" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.convert_params">
<span class="sig-name descname"><span class="pre">convert_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ndim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_inds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cocycle_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.convert_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.cycle_cocycle">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cycle_cocycle</span></span><a class="headerlink" href="#invcryrep.tobascco_net.Net.cycle_cocycle" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.cycle_cocycle_I">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">cycle_cocycle_I</span></span><a class="headerlink" href="#invcryrep.tobascco_net.Net.cycle_cocycle_I" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.cycle_cocycle_check">
<span class="sig-name descname"><span class="pre">cycle_cocycle_check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vect</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.cycle_cocycle_check" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.debug_print">
<span class="sig-name descname"><span class="pre">debug_print</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.debug_print" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.delete_edge">
<span class="sig-name descname"><span class="pre">delete_edge</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">e</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.delete_edge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.edges_iter">
<span class="sig-name descname"><span class="pre">edges_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.edges_iter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.eon_projection">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">eon_projection</span></span><a class="headerlink" href="#invcryrep.tobascco_net.Net.eon_projection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.get_2d_params">
<span class="sig-name descname"><span class="pre">get_2d_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.get_2d_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.get_3d_params">
<span class="sig-name descname"><span class="pre">get_3d_params</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.get_3d_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.get_cocycle_basis">
<span class="sig-name descname"><span class="pre">get_cocycle_basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.get_cocycle_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>The orientation is important here!</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.get_cycle_basis">
<span class="sig-name descname"><span class="pre">get_cycle_basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.get_cycle_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the basis for the cycle vectors. The total number of cycle vectors
in the basis is E - V + 1 (see n below). Once this number of cycle vectors is found,
the program returns.</p>
<p>NB: Currently the cycle vectors associated with the lattice basis are included
in the cycle basis - this is so that the embedding of the barycentric placement
of the net works out properly. Thus the function self.get_lattice_basis()
should be called prior to this.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.get_index">
<span class="sig-name descname"><span class="pre">get_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.get_index" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.get_lattice_basis">
<span class="sig-name descname"><span class="pre">get_lattice_basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.get_lattice_basis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.get_metric_tensor">
<span class="sig-name descname"><span class="pre">get_metric_tensor</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.get_metric_tensor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.get_voltage">
<span class="sig-name descname"><span class="pre">get_voltage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cycle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.get_voltage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.graph">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">graph</span></span><a class="headerlink" href="#invcryrep.tobascco_net.Net.graph" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.in_edges">
<span class="sig-name descname"><span class="pre">in_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vertex</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.in_edges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.indices_with_voltage">
<span class="sig-name descname"><span class="pre">indices_with_voltage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">volt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.indices_with_voltage" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.insert_and_join">
<span class="sig-name descname"><span class="pre">insert_and_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vfrom</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vto</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.insert_and_join" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.is_integral">
<span class="sig-name descname"><span class="pre">is_integral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vect</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.is_integral" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.iter_cycles">
<span class="sig-name descname"><span class="pre">iter_cycles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">node</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cycle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">used</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nodes_visited</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cycle_baggage</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">counter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.iter_cycles" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursive method to iterate over all cycles of a graph.
NB: Not tested to ensure completeness, however it does find cycles.
NB: Likely produces duplicate cycles along different starting points
<strong>last point fixed but not tested</strong></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.kernel">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">kernel</span></span><a class="headerlink" href="#invcryrep.tobascco_net.Net.kernel" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.lattice_arcs">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">lattice_arcs</span></span><a class="headerlink" href="#invcryrep.tobascco_net.Net.lattice_arcs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.linear_independent_vectors">
<span class="sig-name descname"><span class="pre">linear_independent_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.linear_independent_vectors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.loop_edges">
<span class="sig-name descname"><span class="pre">loop_edges</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.loop_edges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.minimal">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">minimal</span></span><a class="headerlink" href="#invcryrep.tobascco_net.Net.minimal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.neighbours">
<span class="sig-name descname"><span class="pre">neighbours</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vertex</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.neighbours" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.nodes_iter">
<span class="sig-name descname"><span class="pre">nodes_iter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.nodes_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Oh man, fixing to networkx 2.0</p>
<p>This probably breaks a lot of stuff in the code. THANKS NETWORKX!!!!!!!1</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.order">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">order</span></span><a class="headerlink" href="#invcryrep.tobascco_net.Net.order" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.out_edges">
<span class="sig-name descname"><span class="pre">out_edges</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vertex</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.out_edges" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.print_edge_count">
<span class="sig-name descname"><span class="pre">print_edge_count</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.print_edge_count" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.projection">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">projection</span></span><a class="headerlink" href="#invcryrep.tobascco_net.Net.projection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.report_errors">
<span class="sig-name descname"><span class="pre">report_errors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fit</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.report_errors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.report_errors_nlopt">
<span class="sig-name descname"><span class="pre">report_errors_nlopt</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.report_errors_nlopt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.return_coeff">
<span class="sig-name descname"><span class="pre">return_coeff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.return_coeff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.return_indices">
<span class="sig-name descname"><span class="pre">return_indices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.return_indices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#invcryrep.tobascco_net.Net.shape" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.simple_cycle_basis">
<span class="sig-name descname"><span class="pre">simple_cycle_basis</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.simple_cycle_basis" title="Permalink to this definition">¶</a></dt>
<dd><p>Cycle basis is constructed using a minimum spanning tree.
This tree is traversed, and all the remaining edges are added
to obtain the basis.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.to_ind">
<span class="sig-name descname"><span class="pre">to_ind</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">str_obj</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.to_ind" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.vertex_positions">
<span class="sig-name descname"><span class="pre">vertex_positions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">used</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bad_ones</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.vertex_positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursive function to find the nodes in the unit cell.
How it should be done:</p>
<p>Create a growing tree around the init placed vertex. Evaluate
which vertices wind up in the unit cell and place them.  Continue
growing from those vertices in the unit cell until all are found.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.Net.vertices">
<span class="sig-name descname"><span class="pre">vertices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vertex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.Net.vertices" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.SystreDB">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">invcryrep.tobascco_net.</span></span><span class="sig-name descname"><span class="pre">SystreDB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.SystreDB" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
<p>A dictionary which reads a file of the same format read by Systre</p>
<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.SystreDB.Nd_chunks">
<span class="sig-name descname"><span class="pre">Nd_chunks</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.SystreDB.Nd_chunks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.SystreDB.gen_networkx_graph_format">
<span class="sig-name descname"><span class="pre">gen_networkx_graph_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.SystreDB.gen_networkx_graph_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the edges from a systre db file and convert
to a networkx graph readable format.</p>
<p>Assumes that the direction of the edge goes from
[node1] —&gt; [node2]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.SystreDB.gen_sage_graph_format">
<span class="sig-name descname"><span class="pre">gen_sage_graph_format</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.SystreDB.gen_sage_graph_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Take the edges from a systre db file and convert
to sage graph readable format.</p>
<p>Assumes that the direction of the edge goes from
[node1] —&gt; [node2]</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.SystreDB.get_key">
<span class="sig-name descname"><span class="pre">get_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.SystreDB.get_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.SystreDB.get_name">
<span class="sig-name descname"><span class="pre">get_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">block</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.SystreDB.get_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="invcryrep.tobascco_net.SystreDB.read_store_file">
<span class="sig-name descname"><span class="pre">read_store_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#invcryrep.tobascco_net.SystreDB.read_store_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads and stores the nets in the self.file file.
Note, this is specific to a systre.arc file and may be subject to
change in the future depending on the developments ODF makes on
Systre.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-invcryrep">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-invcryrep" title="Permalink to this heading">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">SLCIES</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Hang Xiao.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.1.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/invcryrep.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>